<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:strings="clr-namespace:UltimateVideoBrowser.Resources.Strings"
             x:Class="UltimateVideoBrowser.Views.IndexingProgressPage"
             Title="{x:Static strings:AppResources.Indexing}"
             BackgroundColor="{DynamicResource AppBg}">
    <ContentPage.Content>
        <VerticalStackLayout Padding="16"
                             Spacing="10">
            <Label Text="{x:Static strings:AppResources.Indexing}"
                   FontAttributes="Bold"
                   TextColor="{DynamicResource OnSurface}" />

            <Label Text="{Binding IndexStatus}"
                   TextColor="{DynamicResource OnSurfaceMuted}" />

            <Label
                Text="{Binding IndexCurrentFolder, StringFormat={x:Static strings:AppResources.IndexingFolderFormat}}"
                TextColor="{DynamicResource OnSurfaceMuted}"
                FontSize="12" />

            <Label Text="{Binding IndexCurrentFile, StringFormat={x:Static strings:AppResources.IndexingFileFormat}}"
                   TextColor="{DynamicResource OnSurfaceMuted}"
                   FontSize="12" />

            <Label Text="{Binding IndexedCount, StringFormat={x:Static strings:AppResources.NewItemsFormat}}"
                   TextColor="{DynamicResource OnSurfaceMuted}" />

            <Grid ColumnDefinitions="*,Auto,Auto"
                  ColumnSpacing="10">
                <ProgressBar Progress="{Binding IndexRatio}"
                             HorizontalOptions="FillAndExpand"
                             VerticalOptions="Center" />
                <Label Grid.Column="1"
                       Text="{Binding IndexRatio, StringFormat='{0:P0}'}"
                       VerticalOptions="Center"
                       TextColor="{DynamicResource OnSurfaceMuted}" />
                <Button Grid.Column="2"
                        Text="{x:Static strings:AppResources.IndexingBackgroundButton}"
                        Command="{Binding DismissIndexOverlayCommand}"
                        Style="{StaticResource OverlayButtonStyle}"
                        Padding="10,6"
                        CornerRadius="12" />
            </Grid>

            <Label Text="{Binding IndexWorkStatus}"
                   TextColor="{DynamicResource OnSurfaceMuted}"
                   FontSize="12"
                   IsVisible="{Binding HasIndexWorkStatus}" />

            <Button Text="{x:Static strings:AppResources.IndexingCancelButton}"
                    Command="{Binding CancelIndexCommand}"
                    Style="{StaticResource OverlayButtonStyle}"
                    Padding="12,8"
                    CornerRadius="12"
                    HorizontalOptions="End" />
        </VerticalStackLayout>
    </ContentPage.Content>
</ContentPage>